<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Supply Chain Blockchain</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.10.0/dist/ethers.umd.min.js"></script>
</head>
<body>

  <h1>ğŸ“¦ Há»† THá»NG THEO DÃ•I CHUá»–I CUNG á»¨NG</h1>

  <button onclick="connectWallet()">ğŸ”— Káº¿t ná»‘i MetaMask</button>
  <p id="account">ChÆ°a káº¿t ná»‘i</p>

  <div class="container">
    <!-- BÃŠN TRÃI: Nghiá»‡p vá»¥ -->
    <div class="left-section">
      <h2>ğŸ“‹ QUáº¢N LÃ CHUá»–I CUNG á»¨NG</h2>

      <h3>âš™ï¸ CÃ i Ä‘áº·t Contract</h3>
      <input id="leftContractAddress" placeholder="Nháº­p Ä‘á»‹a chá»‰ Smart Contract (0x...)">
      <button onclick="setLeftContractAddress()">Äáº·t Contract</button>
      <div id="leftContractMsg" style="margin-top:8px;color:blue;font-weight:600"></div>

      <hr>

      <h3>1ï¸âƒ£ Táº¡o sáº£n pháº©m (Manufacturer)</h3>
      <input id="productName" placeholder="TÃªn sáº£n pháº©m">
      <input id="deliveryList" placeholder="Danh sÃ¡ch giao hÃ ng (cÃ¡ch nhau báº±ng dáº¥u ,)">
      <input id="retailerAddress" placeholder="Äá»‹a chá»‰ cá»­a hÃ ng">
      <button onclick="createProduct()">Táº¡o sáº£n pháº©m</button>
      <div id="createMsg" style="margin-top:8px;color:green;font-weight:600"></div>
      <div id="createdId" style="margin-top:8px;color:green;font-weight:700"></div>

      <hr>

      <h3>2ï¸âƒ£ Delivery ship hÃ ng</h3>
      <input id="shipId" placeholder="ID sáº£n pháº©m">
      <button onclick="shipProduct()">Ship</button>
      <div id="shipMsg" style="margin-top:8px;color:green;font-weight:600"></div>

      <hr>

      <h3>3ï¸âƒ£ Retailer nháº­n hÃ ng</h3>
      <input id="receiveId" placeholder="ID sáº£n pháº©m">
      <button onclick="receiveProduct()">Nháº­n hÃ ng</button>
      <div id="receiveMsg" style="margin-top:8px;color:green;font-weight:600"></div>
    </div>

    <!-- BÃŠN PHáº¢I: Xem thÃ´ng tin & lá»‹ch sá»­ -->
    <div class="right-section">
      <h2>ğŸ” XEM THÃ”NG TIN & Lá»ŠCH Sá»¬</h2>

      <h3>âš™ï¸ CÃ i Ä‘áº·t Contract</h3>
      <input id="contractAddress" placeholder="Nháº­p Ä‘á»‹a chá»‰ Smart Contract (0x...)">
      <button onclick="setContractAddress()">Äáº·t Contract</button>
      <div id="contractMsg" style="margin-top:8px;color:blue;font-weight:600"></div>

      <hr>

      <h3>ğŸ” TÃ¬m sáº£n pháº©m</h3>
      <input id="viewId" placeholder="Nháº­p ID sáº£n pháº©m">
      <button onclick="viewProduct()">Xem</button>
      <div id="viewMsg" style="margin-top:8px;color:crimson;font-weight:600"></div>

      <pre id="result"></pre>
    </div>
  </div>

  <script>
    // Kiá»ƒm tra nhanh xem ethers cÃ³ load Ä‘Æ°á»£c khÃ´ng, náº¿u khÃ´ng sáº½ thÃ´ng bÃ¡o rÃµ rÃ ng
    if (typeof window.ethers === "undefined") {
      console.warn("Ethers.js chÆ°a Ä‘Æ°á»£c táº£i (window.ethers undefined). Náº¿u trang bá»‹ cháº·n tÃ i nguyÃªn, kiá»ƒm tra káº¿t ná»‘i máº¡ng hoáº·c CSP.");
      // Hiá»ƒn thá»‹ cáº£nh bÃ¡o nhá» trÃªn UI khi ngÆ°á»i dÃ¹ng cá»‘ káº¿t ná»‘i
      window.addEventListener('DOMContentLoaded', () => {
        const acc = document.getElementById('account');
        if (acc && acc.innerText === 'ChÆ°a káº¿t ná»‘i') {
          acc.innerText = 'ChÆ°a káº¿t ná»‘i â€” Ethers.js chÆ°a sáºµn sÃ ng';
        }
      });
    }
  </script>

  <script src="app.js"></script>
</body>
</html>
